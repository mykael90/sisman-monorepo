// This file is reserved for Prisma models related to SIPAC (Sistema Integrado de Patrimônio, Administração e Contratos) integration.
// Models defined here will handle data structures specific to SIPAC, if and when integration is implemented.

// Represents material data from SIPAC.
model SipacMaterial {
    idMaterial               Int      @id // Identificador do material.
    ativo                    Boolean // Indica se o material está ativo.
    codigo                   String   @unique // Código do material.
    codigoSidec              String? // Código do material no sistema do governo SIDEC.
    consumoEnergia           Decimal? @db.Decimal(12, 4) // Consumo de energia.
    dataUltimaCompra         DateTime @db.Timestamp(0) // Data da última compra do material (timestamp).
    denominacaoGrupo         String? // Denominação do grupo do material.
    denominacaoMaterial      String // Denominação do material.
    denominacaoMaterialAscii String? // Denominação do material em ASCII.
    denominacaoSubGrupo      String? // Denominação do sub-grupo do material.
    denominacaoUnidade       String? // Denominação da unidade do material.
    especificacao            String? // Especificação do material.
    especificacaoAscii       String? // Especificação do material em ASCII.
    idGrupo                  Int? // Identificador do grupo do material.
    idSubGrupo               Int? // Identificador do sub-grupo do material.
    precoCompra              Decimal? @db.Decimal(12, 4) // Preço de compra do material.
    valorEstimado            Decimal? @db.Decimal(12, 4) // Valor estimado do material.

    createdAt DateTime @default(now()) @db.Timestamp(0)
    updatedAt DateTime @updatedAt @db.Timestamp(0)

    //Relations
    grupo               SipacGrupoMaterial?           @relation(fields: [idGrupo], references: [idGrupoMaterial])
    subGrupo            SipacSubGrupoMaterial?        @relation(fields: [idSubGrupo], references: [idSubGrupoMaterial])
    requisicoesMaterial SipacItemRequisicaoMaterial[]

    @@index([codigo])
    @@index([idGrupo])
    @@map("sipac_materiais")
}

// Representa um grupo de material do sistema.
model SipacGrupoMaterial {
    idGrupoMaterial   Int     @id // Identificador do grupo.
    ativo             Boolean // Indica se um grupo material está ativo ou não.
    codigo            BigInt  @unique // Código do grupo.
    denominacao       String // Nome do grupo.
    descricao         String? // Descrição detalhada do grupo de material.
    idElementoDespesa Int? // Identificador do elemento de despesa associado ao grupo de material.

    createdAt                DateTime                  @default(now()) @db.Timestamp(0)
    updatedAt                DateTime                  @updatedAt @db.Timestamp(0)
    sipacMateriais           SipacMaterial[]
    subGrupos                SipacSubGrupoMaterial[]
    sipacRequisicoesMaterial SipacRequisicaoMaterial[]

    @@index([codigo])
    @@map("sipac_grupos_materiais")
}

// Representa um sub-grupo de material do sistema.
model SipacSubGrupoMaterial {
    idSubGrupoMaterial Int    @id // Identificador do subgrupo.
    codigo             BigInt @unique // Código identificador do subgrupo. Junção do código do grupo mais um sequencial.
    denominacao        String // Descrição resumida do subgrupo.
    idGrupoMaterial    Int // Identificador do grupo.

    createdAt          DateTime            @default(now()) @db.Timestamp(0)
    updatedAt          DateTime            @updatedAt @db.Timestamp(0)
    sipacMateriais     SipacMaterial[]
    SipacGrupoMaterial SipacGrupoMaterial? @relation(fields: [idGrupoMaterial], references: [idGrupoMaterial])

    @@index([codigo])
    @@index([idGrupoMaterial])
    @@map("sipac_sub_grupos_materiais")
}

// Representa os dados de uma requisição de material do SIPAC.
model SipacRequisicaoMaterial {
    id                            Int       @id // Identificador único da requisição.
    numeroDaRequisicao            String    @unique // Número da requisição no SIPAC (ex: "10990/2025").
    tipoDaRequisicao              String? // Tipo da requisição (ex: "REQUISIÇÃO DE MATERIAL").
    tipoId                        Int? // Identificador do tipo de requisição.
    convenio                      String? // Indica se há convênio (ex: "Não").
    grupoDeMaterial               String? // Grupo de material (ex: "(0)").
    grupoMaterialId               Int? // Identificador do grupo de material.
    unidadeDeCusto                String // Unidade de custo (ex: "INSTITUTO METROPOLE DIGITAL (11.00.05)").
    unidadeRequisitante           String // Unidade requisitante (ex: "DIRETORIA DE MANUTENÇÃO DE INSTALAÇÕES FÍSICAS (11.08.05)").
    destinoDaRequisicao           String? // Destino da requisição (ex: "SUSTENTAÇÃO DE ESTOQUE DO ALMOXARIFADO DA SUP. INFRAESTRUTURA (11.89)").
    usuarioLogin                  String // Usuário que cadastrou a requisição (ex: "edivan.nascimento - EDIVAN DO NASCIMENTO (Ramal: )").
    usuarioId                     Int? // Identificador do usuário que cadastrou a requisição.
    dataDeCadastro                DateTime  @db.Timestamp(0) // Data de cadastro da requisição.
    dataDeEnvio                   DateTime? @db.Timestamp(0) // Data de envio da requisição.
    valorDaRequisicao             Decimal   @db.Decimal(12, 2) // Valor total da requisição.
    valorDoTotalAtendido          Decimal?  @db.Decimal(12, 2) // Valor total atendido da requisição.
    opcaoOrcamentaria             String? // Opção orçamentária (ex: "SOLICITAR AUTORIZAÇÃO ORÇAMENTÁRIA").
    numeroDaRequisicaoRelacionada String? // Número da requisição relacionada (ex: "1164/ 2025 (REQUISIÇÃO DE MANUTENÇÃO)").
    local                         String? // Local da requisição (ex: "INSTITUTO METROPOLE DIGITAL - CIVT").
    observacoes                   String?   @db.Text // Observações gerais da requisição.
    statusAtual                   String // Status atual da requisição (ex: "FINALIZADA").
    almoxarifado                  String // Identificação do almoxarifado
    almoxarifadoId                Int?

    createdAt DateTime @default(now()) @db.Timestamp(0)
    updatedAt DateTime @updatedAt @db.Timestamp(0)

    // Relations
    itensDaRequisicao           SipacItemRequisicaoMaterial[]
    historicoDaRequisicao       SipacHistoricoRequisicaoMaterial[]
    totalizacaoElementosDespesa SipacTotalizacaoElementoDespesaMaterial[]
    detalhesAquisicao           SipacDetalheAquisicaoItemMaterial[]
    grupoMaterial               SipacGrupoMaterial?                       @relation(fields: [grupoMaterialId], references: [idGrupoMaterial])

    @@index([numeroDaRequisicao])
    @@map("sipac_requisicoes_materiais")
}

// Representa um item de uma requisição de material do SIPAC.
model SipacItemRequisicaoMaterial {
    id                  Int      @id @default(autoincrement()) // Identificador único do item.
    numeroItem          Int // Número sequencial do item na requisição.
    codigo              String // Código do material.
    quantidade          Int // Quantidade solicitada.
    valor               Decimal  @db.Decimal(12, 2) // Valor unitário do item.
    total               Decimal  @db.Decimal(12, 2) // Valor total do item (quantidade * valor).
    quantidadeAtendida  Int // Quantidade atendida do item.
    quantidadeDevolvida Int // Quantidade devolvida do item.
    quantidadeEmCompra  Int // Quantidade em processo de compra.
    valorAtendimento    Decimal? @db.Decimal(12, 2) // Valor unitário do atendimento.
    totalAtendimento    Decimal? @db.Decimal(12, 2) // Valor total do atendimento.
    status              String // Status do item (ex: "ATENDIDO").

    requisicaoId Int? // Chave estrangeira para SipacRequisicaoMaterial.
    requisicao   SipacRequisicaoMaterial? @relation(fields: [requisicaoId], references: [id], onDelete: Cascade)

    material SipacMaterial @relation(fields: [codigo], references: [codigo])

    createdAt DateTime @default(now()) @db.Timestamp(0)
    updatedAt DateTime @updatedAt @db.Timestamp(0)

    @@index([requisicaoId])
    @@map("sipac_itens_requisicao_material")
}

// Representa uma entrada no histórico de uma requisição de material do SIPAC.
model SipacHistoricoRequisicaoMaterial {
    id          Int      @id @default(autoincrement()) // Identificador único da entrada de histórico.
    dataHora    DateTime @db.Timestamp(0) // Data e hora do evento.
    status      String // Status atribuído no evento (ex: "CADASTRADA", "AUTORIZADA").
    usuario     String // Usuário responsável pelo evento.
    observacoes String?  @db.Text // Observações do evento.

    requisicaoId Int // Chave estrangeira para SipacRequisicaoMaterial.
    requisicao   SipacRequisicaoMaterial @relation(fields: [requisicaoId], references: [id], onDelete: Cascade)

    createdAt DateTime @default(now()) @db.Timestamp(0)
    updatedAt DateTime @updatedAt @db.Timestamp(0)

    @@index([requisicaoId])
    @@map("sipac_historico_requisicao_material")
}

// Representa a totalização por elemento de despesa de uma requisição de material.
model SipacTotalizacaoElementoDespesaMaterial {
    id              Int     @id @default(autoincrement()) // Identificador único.
    grupoDeMaterial String // Descrição do grupo de material e elemento de despesa.
    total           Decimal @db.Decimal(12, 2) // Valor total para o grupo.

    requisicaoId Int? // Chave estrangeira para SipacRequisicaoMaterial.
    requisicao   SipacRequisicaoMaterial? @relation(fields: [requisicaoId], references: [id], onDelete: Cascade)

    createdAt DateTime @default(now()) @db.Timestamp(0)
    updatedAt DateTime @updatedAt @db.Timestamp(0)

    @@index([requisicaoId])
    @@map("sipac_totalizacao_elemento_despesa_material")
}

// Representa os detalhes da aquisição dos itens de uma requisição.
model SipacDetalheAquisicaoItemMaterial {
    id                   Int     @id @default(autoincrement()) // Identificador único.
    compras              String? // Informações sobre processos de compra.
    empenhos             String? // Informações sobre empenhos.
    notasFiscais         String? // Informações sobre notas fiscais.
    processosDePagamento String? // Informações sobre processos de pagamento.

    requisicaoId Int // Chave estrangeira para SipacRequisicaoMaterial.
    requisicao   SipacRequisicaoMaterial @relation(fields: [requisicaoId], references: [id], onDelete: Cascade)

    createdAt DateTime @default(now()) @db.Timestamp(0)
    updatedAt DateTime @updatedAt @db.Timestamp(0)

    @@index([requisicaoId])
    @@map("sipac_detalhe_aquisicao_item_material")
}
